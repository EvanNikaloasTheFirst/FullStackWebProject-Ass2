<?phpnamespace jobs\Controllers;class Enquiry{    private $enquiry;    public function __construct($enquiry)    {        $this->enquiry = $enquiry;    }    public function enquiries()    {        $allEnquiries = $this->enquiry->findAll();        return ['templates' => 'allEnquiries.html.php',            'title' => 'Enquiries',            'variables' => ['allEnquiries' => $allEnquiries            ]];    }    public function enquiryList(){        $variable1 = 'Completed';        $variable2 = 'Y';        $variable3 = '=';        $allEnquiries = $this->enquiry->findOtherJobs($variable1,$variable3,$variable2);        return ['templates' => 'enquiryList.html.php',            'title' => 'Enquiries',            'variables' => ['allEnquiries' => $allEnquiries            ]];    }    public function RespondToenquiries()    {        $success ='';        $this->isStaffLogged();        $user = $this->enquiry->find('id', $_GET['id']);        return ['templates' => 'EnquiryResponse.html.php',            'title' => 'Respond to enquiries',            'variables' => ['user' => $user,'success'=>$success            ]];    }    public function RespondToenquiriesSubmit()    {        $this->isStaffLogged();        $errors = [];            $updateResponse =                ['id' => $_POST['id'],                    'name' => $_POST['name'],                    'email' => $_POST['email'],                    'EnquiryResponse' => $_POST['response'],                    'Staffid' => $_SESSION['userId'],                    'completed' => $_POST['completed']                ];            $user = $this->enquiry->find('id', $_POST['id']);// Error check to ensure there form has been filled in correctly            $errors += $this->testEnquiryApplyBlankEnquiryResponse($updateResponse);            $errors += $this->testEnquiryApplyBlankName($updateResponse);            if (count($errors) == 0) {                $success = $this->enquiry->update($updateResponse);                $response = 'Your enquiry has been added';            } else{                $response = 'There as been some errors';                $success = array_values($errors);            }        return ['templates' => 'EnquiryResponse.html.php',            'title' => 'Respond to enquiries',            'variables' => ['success' => $success, 'response'=>$response,'user'=>$user            ]        ];    }    public function contact()    {        $success = '';        return ['templates' => 'contact.html.php',            'title' => 'Add a job',            'variables' => ['success' => $success            ]        ];    }    public function contactSubmit()    {            $errors=[];            $job = [                'name' => $_POST['name'],                'email' => $_POST['email'],                'telephone' => $_POST['telephone'],                'enquiry' => $_POST['enquiry'],                'userId' => $_SESSION['userId']            ];        // Error check to ensure there form has been filled in correctly        $errors += $this->testEnquiryApplyAllBlank( $job);            $errors += $this->testEnquiryApplyBlankEnquiry($job);            $errors += $this->testEnquiryApplyBlankEmail($job);            $errors += $this->testEnquiryApplyBlankName($job);            $errors += $this->testEnquiryApplyAllBlank($job);            if (count($errors) == 0) {                $success = $this->enquiry->insert($job);                $response = 'Your enquiry was submitted';            } else{                $success = array_values($errors);                $response = 'Your enquiry was not submitted';            }        return ['templates' => 'contact.html.php',            'title' => 'Contact',            'variables' => ['success' => $success, 'response' => $response            ]        ];    }        public function testEnquiryApplyAllBlank($job){            $errors = [];            if ($job['name'] == ''){                $errors[] = 'You must enter a name';            }            if ($job['email'] == ''){                $errors[] = 'You must enter a email';            }            if ($job['telephone'] == ''){                $errors[] = 'You must enter a telephone number';            }            if ($job['enquiry'] == ''){                $errors[] = 'You must enter an enquiry';            }            return $errors;        }    public function testEnquiryApplyBlankName($job){        $errors = [];        if ($job['name'] == ''){            $errors[] = 'You must enter a name';        }        return $errors;    }    public function testEnquiryApplyBlankEmail($job){        $errors = [];        if ($job['email'] == ''){            $errors[] = 'You must enter an email';        }        return $errors;    }    public function testEnquiryApplyBlankEnquiry($job){        $errors = [];        if (empty($job['enquiry'])){            $errors[] = 'You must enter an enquiry';        }        return $errors;    }    public function testEnquiryApplyBlankEnquiryResponse($job){        $errors = [];        if ($job['EnquiryResponse'] == ''){            $errors[] = 'You must enter a response';        }        return $errors;    }    public function isStaffLogged(){        if ($_SESSION['AdminLoggedIn'] == true ||  $_SESSION['StaffLoggedIn'] == true) {        }        else {            header('location: /User/login');            exit();        }    }}