<?phpnamespace jobs\Controllers;//session_start();class User{    private $jobTable;    private $userTable;    private $enquiry;    private $categoriesTable;    public function __construct($userTable)    {        $this->userTable = $userTable;    }    public function login()    {        $success = '';        return ['templates' => 'login.html.php',            'title' => 'Log in',            'variables' => ['success'=> $success            ]        ];    }    public function loginSubmit()    {            $user = $this->userTable->find('username', $_POST['username'])[0];            if (($user['username'] == $_POST['username']) && $user['password'] == $_POST['password'] && $user['Admin'] == 'Y') {                $_SESSION['AdminLoggedIn'] = true;                $_SESSION['userId'] = $user['id'];                $success = 'Admin has been logged in';            } else if (($user['username'] == $_POST['username'])                && $user['password'] == $_POST['password'] && $user['Staff'] == 'Y') {                $_SESSION['StaffLoggedIn'] = true;                $_SESSION['userId'] = $user['id'];                $success = 'Staff has been logged in';            } else if (($user['username'] == $_POST['username'])                && $user['password'] == $_POST['password'] && $user['Client'] == 'Y') {                $_SESSION['ClientLoggedIn'] = true;                $_SESSION['userId'] = $user['id'];                $success = 'Client has been logged in';            }            else{                $success = 'Invalid details';            }        return ['templates' => 'login.html.php',            'title' => 'Log in',            'variables' => ['success' => $success,            ]        ];    }    public function logout(){    $_SESSION['StaffLoggedIn'] = false;    $_SESSION['ClientLoggedIn'] = false;    $_SESSION['AdminLoggedIn'] = false;    $_SESSION['userId'] = null;        $success = 'You have been logged out';        return ['templates' => 'login.html.php',            'title' => 'Log out',            'variables' => ['success' => $success            ]        ];    }    public function staffList(){        $staff = $this->userTable->findAll();        return ['templates' => 'StaffList.html.php',            'title' => 'All staff members',            'variables' => [                'staff' => $staff            ]        ];    }    public function grantStaffAccess(){        $table = 'user';        $columns = 'Staff';        $this->userTable->grantAccess($table, $columns);        header('location: /User/stafflist');    }    public function removeStaffAccess(){        $table = 'user';        $columns = 'Staff';        $this->userTable->removeAccess($table,$columns);        header('location: /User/stafflist');    }    public function deleteStaff() {        $this->userTable->delete($_GET['id']);        header('location: /User/staffList');    }    public function grantAccess()    {        $table = 'user';        $columns = 'Admin';        $this->userTable->grantAccess($table, $columns);        header('location: /User/stafflist');    }    public function removeAccess(){        $table = 'user';        $columns = 'Admin';        $this->userTable->removeAccess($table,$columns);        header('location: /User/stafflist');    }    public function isAdminLogged(){        if (!$_SESSION['AdminLoggedIn']) {            header('location: /User/login');            exit();        }    }}